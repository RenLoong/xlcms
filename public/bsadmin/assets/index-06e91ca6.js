import{d as F,r as C,h as j,a as w,A as V,w as t,k,l as e,y as p,u as n,B as A,$ as u,q as c,D as B,aD as L,v as M,s as Q,aE as O,aF as H,a2 as T,E as J,z as q,G as K,o as W,c as X,a1 as Y,aj as Z,t as ee,ak as le,al as te,an as oe,P as ae}from"./index-3b328f2a.js";/* empty css                   *//* empty css                  *//* empty css                     *//* empty css               *//* empty css                 *//* empty css                        *//* empty css                   */const se={class:"dialog-footer flex"},ne=k("div",{class:"flex-1"},null,-1),re=F({__name:"create-regions",emits:["success"],setup(z,{expose:y,emit:E}){const g=C(!1),h=C([]),b=C(),R=C(),U=j({id:[{required:!0,message:"请输入地区代码",trigger:"blur"}],title:[{required:!0,message:"请输入地区名称",trigger:"blur"}],level:[{required:!0,message:"请选择行政等级",trigger:"change"}],state:[{required:!0,message:"请选择状态",trigger:"change"}]}),l=C({pid_arr:[],title:"",pinyin_prefix:"",level:0,state:1}),s=()=>{u.get("regions/list").then(r=>{r.code===u.ResponseCode.SUCCESS&&(h.value=r.data)}).catch(r=>{c.error(r.message)})},i=r=>{f(),l.value.id=void 0,r()},m=()=>{b.value.validate(r=>{if(r){let o="regions/list/Edit";u.post(o,l.value).then(_=>{_.code===u.ResponseCode.SUCCESS?(c.success(_.message),i(()=>{g.value=!1}),E("success")):c.info(_.message)}).catch(_=>{c.error(_.message)})}else c.warning("请完善表单")})},f=()=>{b.value&&b.value.resetFields()},$=r=>{l.value.pid=r[r.length-1]};return y({open:r=>{h.value.length<=0&&s(),g.value=!0,r&&B(()=>{l.value=Object.assign({},r)})}}),(r,o)=>{const _=L,a=M,v=Q,x=O,N=H,P=T,G=J,D=q,I=K;return w(),V(I,{modelValue:n(g),"onUpdate:modelValue":o[9]||(o[9]=d=>A(g)?g.value=d:null),title:"编辑地区",width:"50%","before-close":i,draggable:"","close-on-click-modal":!1,"close-on-press-escape":!1,class:"form-dialog"},{footer:t(()=>[k("span",se,[e(D,{onClick:o[6]||(o[6]=d=>{i(()=>{g.value=!1})})},{default:t(()=>[p("取消")]),_:1}),ne,e(D,{onClick:o[7]||(o[7]=d=>f())},{default:t(()=>[p("重置")]),_:1}),e(D,{type:"primary",onClick:o[8]||(o[8]=d=>m())},{default:t(()=>[p("提交")]),_:1})])]),default:t(()=>[e(G,{"label-position":"right","label-width":"200px",size:"large",ref_key:"regionsForm",ref:b,class:"w-80",model:n(l),rules:n(U)},{default:t(()=>[e(a,{label:"上级地区"},{default:t(()=>[e(_,{ref_key:"pidRef",ref:R,modelValue:n(l).pid_arr,"onUpdate:modelValue":o[0]||(o[0]=d=>n(l).pid_arr=d),options:n(h),props:{value:"id",label:"title"},onChange:$,placeholder:"默认为省",clearable:"",class:"flex-1"},null,8,["modelValue","options"])]),_:1}),e(a,{label:"地区代码",prop:"id"},{default:t(()=>[e(v,{modelValue:n(l).id,"onUpdate:modelValue":o[1]||(o[1]=d=>n(l).id=d),placeholder:"地区代码"},null,8,["modelValue"])]),_:1}),e(a,{label:"名称",prop:"title"},{default:t(()=>[e(v,{modelValue:n(l).title,"onUpdate:modelValue":o[2]||(o[2]=d=>n(l).title=d),placeholder:"地区名称"},null,8,["modelValue"])]),_:1}),e(a,{label:"首字母",prop:"pinyin_prefix"},{default:t(()=>[e(v,{modelValue:n(l).pinyin_prefix,"onUpdate:modelValue":o[3]||(o[3]=d=>n(l).pinyin_prefix=d),placeholder:"地区首字母"},null,8,["modelValue"])]),_:1}),e(a,{label:"行政等级",prop:"level"},{default:t(()=>[e(N,{modelValue:n(l).level,"onUpdate:modelValue":o[4]||(o[4]=d=>n(l).level=d)},{default:t(()=>[e(x,{label:0},{default:t(()=>[p("省")]),_:1}),e(x,{label:1},{default:t(()=>[p("市")]),_:1}),e(x,{label:2},{default:t(()=>[p("区")]),_:1}),e(x,{label:3},{default:t(()=>[p("街道")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(a,{label:"状态",prop:"state"},{default:t(()=>[e(P,{modelValue:n(l).state,"onUpdate:modelValue":o[5]||(o[5]=d=>n(l).state=d),"active-value":1,"inactive-value":0,style:{"--el-switch-on-color":"var(--el-color-success)"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}}),ie={class:"bg-white rounded-4 p-4 flex-1 overflow-hidden flex flex-column"},de={class:"flex pb-4"},ce=k("div",{class:"flex-1"},null,-1),ue={class:"text-uppercase"},pe=F({name:"/regions"}),we=F({...pe,setup(z){const y=C([]),E=C(),g=(l,s,i)=>{u.get("regions/list/Query",{params:{id:l.id}}).then(m=>{m.code===u.ResponseCode.SUCCESS&&i(m.data)}).catch(m=>{c.error(m.message)})},h=()=>{u.get("regions/list/Query").then(l=>{l.code===u.ResponseCode.SUCCESS&&(y.value=l.data)}).catch(l=>{c.error(l.message)})},b=()=>{const l=le.service();u.get("regions/list/Cache").then(s=>{l.close(),s.code===u.ResponseCode.SUCCESS?c.success(s.message):c.info(s.message)}).catch(s=>{l.close(),c.error(s.message)})},R=l=>{const s=l.row.state?0:1;u.post("regions/list/SetState",{id:l.row.id}).then(i=>{if(i.code===u.ResponseCode.SUCCESS)c.success(i.message);else throw new Error(i.message)}).catch(i=>{c.error(i.message),B(()=>{l.row.state=s})})},U=l=>{u.post("regions/list/Delete",{id:l.row.id}).then(s=>{s.code===u.ResponseCode.SUCCESS?(c.success(s.message),y.value=[],h()):c.info(s.message)}).catch(s=>{c.error(s.message)})};return W(()=>{h()}),(l,s)=>{const i=q,m=Y,f=te,$=T,S=oe,r=ae,o=Z,_=re;return w(),X("div",ie,[k("div",de,[e(m,{effect:"dark",content:"刷新缓存",placement:"bottom-end"},{default:t(()=>[e(i,{type:"warning",icon:"Refresh",onClick:b})]),_:1}),e(m,{effect:"dark",content:"创建地区",placement:"bottom-end"},{default:t(()=>[e(i,{type:"primary",icon:"Plus",onClick:s[0]||(s[0]=a=>n(E).open())},{default:t(()=>[p("创建")]),_:1})]),_:1}),ce]),e(o,{data:n(y),style:{width:"100%",height:"100%"},"row-key":"id",border:"",lazy:"",load:g,"tree-props":{children:"children",hasChildren:"hasChildren"}},{default:t(()=>[e(f,{prop:"id",label:"地区代码",width:"200"}),e(f,{prop:"title",label:"名称","min-width":"200"}),e(f,{label:"状态",width:"80"},{default:t(a=>[e($,{modelValue:a.row.state,"onUpdate:modelValue":v=>a.row.state=v,"active-value":1,"inactive-value":0,style:{"--el-switch-on-color":"var(--el-color-success)"},onChange:v=>R(a)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(f,{prop:"level",label:"行政等级",width:"120"},{default:t(a=>[a.row.level===0?(w(),V(S,{key:0,type:"danger"},{default:t(()=>[p("省")]),_:1})):a.row.level===1?(w(),V(S,{key:1},{default:t(()=>[p("市")]),_:1})):a.row.level===2?(w(),V(S,{key:2,type:"warning"},{default:t(()=>[p("区")]),_:1})):(w(),V(S,{key:3,type:"success"},{default:t(()=>[p("街道")]),_:1}))]),_:1}),e(f,{prop:"pinyin_prefix",label:"首字母",width:"100"},{default:t(a=>[k("span",ue,ee(a.row.pinyin_prefix),1)]),_:1}),e(f,{fixed:"right",label:"#",width:"160"},{default:t(a=>[e(m,{effect:"dark",content:"编辑",placement:"left"},{default:t(()=>[e(i,{type:"primary",icon:"Edit",size:"small",onClick:v=>n(E).open(a.row)},null,8,["onClick"])]),_:2},1024),e(r,{icon:"Delete","icon-color":"var(--el-color-danger)",title:"确定继续删除该数据及子数据吗？",width:"200px","confirm-button-text":"继续删除","confirm-button-type":"danger",onConfirm:v=>U(a)},{reference:t(()=>[e(i,{type:"danger",icon:"Delete",size:"small"})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"]),e(_,{ref_key:"createRegionsRef",ref:E,onSuccess:h},null,512)])}}});export{we as default};
