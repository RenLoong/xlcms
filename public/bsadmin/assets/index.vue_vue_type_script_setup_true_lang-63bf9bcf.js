import{d as z,r as v,o as R,ab as q,a as m,c as E,k as i,l as a,w as o,u as c,$ as u,q as p,a1 as Q,aj as L,Q as M,p as k,y as b,t as _,I as F,J,A as f,K as y,D as K,z as G,al as H,ad as O,an as W,a2 as X,ag as Y,P as Z,am as ee}from"./index-3b328f2a.js";/* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                        *//* empty css                   *//* empty css                  *//* empty css                        */const te={class:"bg-white rounded-4 p-4 flex-1 overflow-hidden flex flex-column"},ae={class:"flex pb-4"},le=i("div",{class:"flex-1"},null,-1),oe={class:"font-weight-600"},se={class:"h10 text-grey"},ne={class:"h10"},ie={class:"h10"},re={class:"px-4 pt-4"},de=z({name:"/article"}),ye=z({...de,props:{classifyAlias:null},setup(V){const d=v({total:0,per_page:10,classify_alias:V.classifyAlias,page:1}),g=v([]),D=t=>{d.value.per_page=t,h()},C=t=>{d.value.page=t,h()},w=v(!1),h=()=>{w.value||(w.value=!0,u.get("article/index/Query",{params:d.value}).then(t=>{g.value=[],t.code===u.ResponseCode.SUCCESS&&(d.value.total=t.data.total,d.value.per_page=t.data.per_page,g.value=t.data.data)}).catch(t=>{p.error(t.message)}).finally(()=>{w.value=!1}))},U=t=>{const s=t.state;t.state_loading=!0,u.post("article/index/SetState",{id:t.id}).then(l=>{if(t.state_loading=!1,l.code===u.ResponseCode.SUCCESS)p.success(l.message);else throw new Error(l.message)}).catch(l=>{t.state_loading=!1,p.error(l.message),K(()=>{t.state=s})})},A=t=>{u.post("article/index/Delete",{id:t.row.id}).then(s=>{s&&(s.code===u.ResponseCode.SUCCESS?(p.success(s.message),C(1)):p.info(s.message))}).catch(s=>{p.error(s.message)})},T=ee((t,s)=>{u.post("article/index/SetSort",{id:s.row.id,sort:t}).then(l=>{if(l.code!==u.ResponseCode.SUCCESS)throw new Error(l.message)}).catch(l=>{p.error(l.message)})},300);return R(()=>{h()}),q(()=>{h()}),(t,s)=>{const l=G,S=Q,n=H,$=O,x=W,B=X,N=Y,j=Z,I=L,P=M;return m(),E("div",te,[i("div",ae,[a(S,{effect:"dark",content:"发布新文章",placement:"bottom-end"},{default:o(()=>[a(l,{type:"primary",icon:"Position",onClick:s[0]||(s[0]=e=>c(k).push({path:"/article/publish",query:{classify_alias:c(d).classify_alias}}))},{default:o(()=>[b("发布")]),_:1})]),_:1}),le]),a(I,{data:c(g),style:{width:"100%",height:"100%"},border:""},{default:o(()=>[a(n,{prop:"id",label:"ID",width:"100"}),a(n,{label:"标题","min-width":"200"},{default:o(e=>[i("div",null,[i("div",oe,_(e.row.title),1),i("div",se,_(e.row.subtitle),1)])]),_:1}),a(n,{label:"别名",prop:"alias",width:"140"}),a(n,{label:"分类",prop:"classify_title",width:"140"}),a(n,{label:"来源",prop:"source",width:"140"}),a(n,{label:"封面",width:"200"},{default:o(e=>[(m(!0),E(F,null,J(e.row.thumb_url,r=>(m(),f($,{style:{width:"30px",height:"30px"},class:"mr-1",src:r,"zoom-rate":1.2,"preview-teleported":"","preview-src-list":e.row.thumb_url,fit:"cover"},null,8,["src","zoom-rate","preview-src-list"]))),256))]),_:1}),a(n,{label:"开放时间",width:"160"},{default:o(e=>[e.row.start_time?(m(),f(x,{key:0,size:"small",type:"info"},{default:o(()=>[b(_(e.row.start_time),1)]),_:2},1024)):y("",!0),e.row.end_time?(m(),f(x,{key:1,size:"small",type:"info"},{default:o(()=>[b(_(e.row.end_time),1)]),_:2},1024)):y("",!0)]),_:1}),a(n,{label:"状态",width:"80"},{default:o(e=>[a(B,{modelValue:e.row.state,"onUpdate:modelValue":r=>e.row.state=r,"active-value":1,"inactive-value":0,style:{"--el-switch-on-color":"var(--el-color-success)"},loading:e.row.state_loading,onChange:r=>U(e.row)},null,8,["modelValue","onUpdate:modelValue","loading","onChange"])]),_:1}),a(n,{label:"浏览量/排序",width:"200"},{default:o(e=>[i("div",ne,[i("div",null,_(e.row.view),1),a(N,{modelValue:e.row.sort,"onUpdate:modelValue":r=>e.row.sort=r,min:0,max:99,step:1,"step-strictly":"",size:"small",onChange:r=>c(T)(r,e)},null,8,["modelValue","onUpdate:modelValue","onChange"])])]),_:1}),a(n,{label:"创建/更新时间",width:"200"},{default:o(e=>[i("div",ie,[i("div",null,_(e.row.create_time),1),i("div",null,_(e.row.update_time),1)])]),_:1}),a(n,{fixed:"right",label:"#",width:"160"},{default:o(e=>[a(S,{effect:"dark",content:"编辑",placement:"left"},{default:o(()=>[a(l,{type:"primary",icon:"Edit",size:"small",onClick:r=>c(k).push({path:"/article/publish",query:{classify_alias:c(d).classify_alias,id:e.row.id}})},null,8,["onClick"])]),_:2},1024),e.row.is_system?y("",!0):(m(),f(j,{key:0,icon:"Delete","icon-color":"var(--el-color-danger)",title:"确定继续删除该数据及子数据吗？",width:"200px","confirm-button-text":"继续删除","confirm-button-type":"danger",onConfirm:r=>A(e)},{reference:o(()=>[a(l,{type:"danger",icon:"Delete",size:"small"})]),_:2},1032,["onConfirm"]))]),_:1})]),_:1},8,["data"]),i("div",re,[a(P,{"page-sizes":[10,20,50,100],"page-size":c(d).per_page,background:"",layout:"total, sizes, prev, pager, next, jumper",total:c(d).total,onSizeChange:D,onCurrentChange:C},null,8,["page-size","total"])])])}}});export{ye as _};
