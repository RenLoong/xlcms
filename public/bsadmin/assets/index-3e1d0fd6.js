import{d as b,r as d,o as y,$ as h,a as I,c as S,u as e,b as M,e as F,f as L,g as N,h as U,i as j,j as z,k as l,l as n,w as i,m as D,n as G,E as O,t as T,p as W,q as f,s as H,v as X}from"./index-3b328f2a.js";/* empty css                     */import{_ as A}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                 */const J=["src"],K=b({__name:"index",props:{bg:{default:"255,255,255"}},emits:["change"],setup(v,{emit:_}){const m=v,p=d("captcha");y(()=>{u()});const u=()=>{p.value=h.getUrl(`/login/captcha?bg=${m.bg}&t=${Date.now()}`),_("change")};return(g,s)=>(I(),S("img",{src:e(p),title:"点击切换验证码",onClick:u,class:"pointer captcha-image"},null,8,J))}});const P=A(K,[["__scopeId","data-v-f80030f9"]]),Q={class:"login-mask"},Y={class:"flex flex-1 flex-center"},Z={class:"text-center p-5"},ee={class:"flex flex-center pb-4"},se={class:"h6 font-weight-600 nav-item active"},te={class:"flex-1 py-5 w-60 mx-auto flex flex-center flex-column"},oe={class:"pt-4 pb-10 flex flex-center"},ne={class:"login-button"},ae=b({name:"/login"}),ue=b({...ae,setup(v){const{setUserInfo:_}=M(),{setMenu:m}=F(),p=L(),{WEBCONFIG:u}=N(p),g=d(),s=U({username:"",password:"",captcha:""}),V=U({username:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],scode:[{required:!0,message:"请输入图形验证码",trigger:"blur"}]}),E=d({login:"login/login"}.login),R=()=>{var a;(a=g.value)==null||a.validate(t=>{t?h.post(E.value,s).then(o=>{o.code===h.ResponseCode.SUCCESS?(m(o.data.menu),_(o.data.user).then(()=>{W.push("/index")}).catch(r=>{console.log(r)}),f.success(o.message)):f.info(o.message)}):f.error("请将表单填写完整")})},k=()=>{s.captcha=""},x=d("");let w;const C=()=>{const a=new XMLHttpRequest;a.open("GET","https://picsum.photos/1920/1080?random",!0),a.responseType="blob",a.onload=function(){if(this.status===200){const t=this.response;x.value=URL.createObjectURL(t)}},a.send()};return y(()=>{C(),w=setInterval(()=>{C()},3e4)}),j(()=>{clearInterval(w)}),(a,t)=>{const o=H,r=X,B=P,$=z("Right"),q=O;return I(),S("div",{class:"login",style:G({backgroundImage:`url(${e(x)})`})},[l("div",Q,[l("div",Y,[n(q,{ref_key:"loginFormRef",ref:g,model:e(s),rules:e(V),class:"login-form bg-filter py-10","label-position":"top","hide-required-asterisk":"","show-message":!1,onSubmit:D(R,["prevent"]),size:"large"},{default:i(()=>[l("div",Z,[l("div",ee,[l("div",se,T(e(u).siteinfo.title)+" 管理员登录",1)])]),l("div",te,[n(r,{label:"用户名",class:"w-100",prop:"username"},{default:i(()=>[n(o,{modelValue:e(s).username,"onUpdate:modelValue":t[0]||(t[0]=c=>e(s).username=c),placeholder:"手机号/用户名/邮箱"},null,8,["modelValue"])]),_:1}),n(r,{label:"密码",class:"w-100",prop:"password"},{default:i(()=>[n(o,{modelValue:e(s).password,"onUpdate:modelValue":t[1]||(t[1]=c=>e(s).password=c),type:"password",placeholder:"密码"},null,8,["modelValue"])]),_:1}),n(r,{label:"图形验证码",class:"w-100",prop:"captcha"},{default:i(()=>[n(o,{modelValue:e(s).captcha,"onUpdate:modelValue":t[2]||(t[2]=c=>e(s).captcha=c),placeholder:"图形验证码"},{append:i(()=>[n(B,{onChange:k})]),_:1},8,["modelValue"])]),_:1})]),l("div",oe,[l("button",ne,[n($,{class:"svgIcon font-weight-bold"})])])]),_:1},8,["model","rules","onSubmit"])])])],4)}}});export{ue as default};
